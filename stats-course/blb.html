<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Bag of Little Bootstraps – Foundations of Statistical Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d279e387f5997211c97d65d1670dc95e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<meta name="shinylive:serviceworker_dir" content=".">
<script src="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/run-python-blocks.js" type="module"></script>
<link href="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/shinylive.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pvalues-ci.html">Inference</a></li><li class="breadcrumb-item"><a href="./blb.html">Bag of Little Bootstraps</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Foundations of Statistical Inference</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Probability &amp; Uncertainty</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variance-sd-se.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variance, SD &amp; Standard Error</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampling-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Sampling Distribution</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">The Central Limit Theorem</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CLT Simulator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lln.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LLN vs CLT</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pvalues-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">p-values &amp; Confidence Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Test Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Bootstrap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blb.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Bag of Little Bootstraps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Power, Alpha, Beta &amp; MDE</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./monte-carlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Monte Carlo Experiments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Testing</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cef.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression &amp; the CEF</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./residuals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Residuals &amp; Controls</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fwl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frisch-Waugh-Lovell</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./omitted-variable-bias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Omitted Variable Bias</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Algebra of Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Algebra Behind OLS</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Estimation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./method-of-moments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Method of Moments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maximum-likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maximum Likelihood</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limited-dependent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Limited Dependent Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Method of Moments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Estimation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Standard Errors &amp; Diagnostics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./heteroskedasticity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Heteroskedasticity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustered-se.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clustered SEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./delta-method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Delta Method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./measurement-error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measurement Error</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bias-variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bias-Variance Tradeoff</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Selection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./degeneracy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">When Inference Breaks Down</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Causal Thinking</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation-causation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">From Correlation to Causation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Bayesian Thinking</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian-updating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Updating</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Foundations of AI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./training-as-mle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Training as Maximum Likelihood</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regularization-priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regularization as Bayesian Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction-vs-causation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prediction vs Causation in Foundation Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimental Design for AI Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calibration-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calibration &amp; Uncertainty Quantification</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-problem-with-the-bootstrap-at-scale" id="toc-the-problem-with-the-bootstrap-at-scale" class="nav-link active" data-scroll-target="#the-problem-with-the-bootstrap-at-scale">The problem with the bootstrap at scale</a></li>
  <li><a href="#the-blb-idea" id="toc-the-blb-idea" class="nav-link" data-scroll-target="#the-blb-idea">The BLB idea</a>
  <ul class="collapse">
  <li><a href="#the-three-steps" id="toc-the-three-steps" class="nav-link" data-scroll-target="#the-three-steps">The three steps</a></li>
  <li><a href="#why-the-reweighting-works" id="toc-why-the-reweighting-works" class="nav-link" data-scroll-target="#why-the-reweighting-works">Why the reweighting works</a></li>
  <li><a href="#cost-comparison" id="toc-cost-comparison" class="nav-link" data-scroll-target="#cost-comparison">Cost comparison</a></li>
  </ul></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a>
  <ul class="collapse">
  <li><a href="#things-to-try" id="toc-things-to-try" class="nav-link" data-scroll-target="#things-to-try">Things to try</a></li>
  </ul></li>
  <li><a href="#when-to-use-blb" id="toc-when-to-use-blb" class="nav-link" data-scroll-target="#when-to-use-blb">When to use BLB</a></li>
  <li><a href="#blb-for-clustered-data" id="toc-blb-for-clustered-data" class="nav-link" data-scroll-target="#blb-for-clustered-data">BLB for clustered data</a>
  <ul class="collapse">
  <li><a href="#connections" id="toc-connections" class="nav-link" data-scroll-target="#connections">Connections</a></li>
  <li><a href="#did-you-know" id="toc-did-you-know" class="nav-link" data-scroll-target="#did-you-know">Did you know?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pvalues-ci.html">Inference</a></li><li class="breadcrumb-item"><a href="./blb.html">Bag of Little Bootstraps</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Bag of Little Bootstraps</h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="the-problem-with-the-bootstrap-at-scale" class="level2">
<h2 class="anchored" data-anchor-id="the-problem-with-the-bootstrap-at-scale">The problem with the bootstrap at scale</h2>
<p>The <a href="bootstrap.html">standard bootstrap</a> is beautifully simple: resample <span class="math inline">\(n\)</span> observations with replacement, re-estimate, repeat <span class="math inline">\(B\)</span> times. But each bootstrap replicate processes all <span class="math inline">\(n\)</span> observations. When <span class="math inline">\(n\)</span> is large and estimation is expensive — panel regressions, kernel estimators, ML models — the bootstrap becomes prohibitively slow:</p>
<p><span class="math display">\[\text{Cost}_{\text{bootstrap}} = O(B \cdot n)\]</span></p>
<p>With <span class="math inline">\(n = 500{,}000\)</span> and <span class="math inline">\(B = 1{,}000\)</span>, you’re fitting your model 1,000 times on half a million observations each. That can take days.</p>
</section>
<section id="the-blb-idea" class="level2">
<h2 class="anchored" data-anchor-id="the-blb-idea">The BLB idea</h2>
<p>The <strong>Bag of Little Bootstraps</strong> (Kleiner, Talwalkar, Sarkar &amp; Jordan, 2014) gets the same answer at a fraction of the cost. The key insight: instead of bootstrapping the full dataset, <strong>subsample small chunks and reweight them to mimic full-sample uncertainty</strong>.</p>
<section id="the-three-steps" class="level3">
<h3 class="anchored" data-anchor-id="the-three-steps">The three steps</h3>
<p><strong>Step 1 — Subsample.</strong> Draw <span class="math inline">\(S\)</span> small subsamples of size <span class="math inline">\(b \ll n\)</span> from the data <strong>without</strong> replacement. A common choice is <span class="math inline">\(b = n^\gamma\)</span> with <span class="math inline">\(\gamma \approx 0.6\text{–}0.9\)</span>:</p>
<p><span class="math display">\[b = n^\gamma, \quad \gamma \in [0.6, 0.9]\]</span></p>
<p>For <span class="math inline">\(n = 500{,}000\)</span> and <span class="math inline">\(\gamma = 0.7\)</span>, you get <span class="math inline">\(b \approx 10{,}000\)</span> — a 50x reduction.</p>
<p><strong>Step 2 — Reweight, don’t resample.</strong> Within each subsample, generate <span class="math inline">\(R\)</span> sets of <strong>multinomial weights</strong> that sum to <span class="math inline">\(n\)</span> (not <span class="math inline">\(b\)</span>). Each weight vector simulates a bootstrap resample from the full population, but you only need to work with <span class="math inline">\(b\)</span> distinct observations:</p>
<p><span class="math display">\[\mathbf{w} \sim \text{Multinomial}(n, \; 1/b, \ldots, 1/b)\]</span></p>
<p>Estimate the parameter using weighted estimation for each weight draw. This gives <span class="math inline">\(R\)</span> estimates per subsample.</p>
<p><strong>Step 3 — Combine.</strong> For each subsample <span class="math inline">\(s\)</span>, compute the bootstrap variance from its <span class="math inline">\(R\)</span> reweighted estimates. Average the variances across the <span class="math inline">\(S\)</span> subsamples:</p>
<p><span class="math display">\[\widehat{\text{Var}}_{\text{BLB}} = \frac{1}{S} \sum_{s=1}^{S} \widehat{\text{Var}}_s\]</span></p>
<p>The resulting SE is asymptotically equivalent to the full bootstrap SE.</p>
</section>
<section id="why-the-reweighting-works" class="level3">
<h3 class="anchored" data-anchor-id="why-the-reweighting-works">Why the reweighting works</h3>
<p>The multinomial weights summing to <span class="math inline">\(n\)</span> are crucial. If you just bootstrapped the subsample of size <span class="math inline">\(b\)</span>, you’d estimate uncertainty for a sample of size <span class="math inline">\(b\)</span> — too much variance. By inflating the weights to sum to <span class="math inline">\(n\)</span>, each reweighted estimate behaves as if it came from a full-size bootstrap resample. The subsample provides the right <em>support</em> (which data points can appear); the weights provide the right <em>scale</em> (how much uncertainty a sample of size <span class="math inline">\(n\)</span> should have).</p>
</section>
<section id="cost-comparison" class="level3">
<h3 class="anchored" data-anchor-id="cost-comparison">Cost comparison</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Method</th>
<th>Replications</th>
<th>Obs per replication</th>
<th>Total cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Bootstrap</strong></td>
<td><span class="math inline">\(B\)</span></td>
<td><span class="math inline">\(n\)</span></td>
<td><span class="math inline">\(O(B \cdot n)\)</span></td>
</tr>
<tr class="even">
<td><strong>BLB</strong></td>
<td><span class="math inline">\(S \cdot R\)</span></td>
<td><span class="math inline">\(b\)</span></td>
<td><span class="math inline">\(O(S \cdot R \cdot b)\)</span></td>
</tr>
</tbody>
</table>
<p>Since <span class="math inline">\(b \ll n\)</span>, BLB is dramatically faster. With <span class="math inline">\(n = 500{,}000\)</span>, <span class="math inline">\(b = 10{,}000\)</span>, <span class="math inline">\(S = 10\)</span>, <span class="math inline">\(R = 100\)</span>: bootstrap does <span class="math inline">\(1{,}000 \times 500{,}000 = 5 \times 10^8\)</span> observation-fits; BLB does <span class="math inline">\(10 \times 100 \times 10{,}000 = 10^7\)</span> — a <strong>50x speedup</strong>.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>The Oracle View.</strong> In this simulation, we know the true parameter and can compute exact bootstrap SEs by brute force. We compare BLB’s SE estimate against the full bootstrap SE and the true sampling distribution. In practice, you’d use BLB <em>because</em> the full bootstrap is too expensive — you trust the theory that they converge.</p>
</div>
</div>
</div>
</section>
</section>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<p>Compare standard bootstrap vs BLB. Left: both SE estimates as <span class="math inline">\(n\)</span> grows (they converge). Right: computation cost — bootstrap scales with <span class="math inline">\(n\)</span>, BLB stays manageable.</p>
<pre class="shinylive-r" data-engine="r"><code>#| standalone: true
#| viewerHeight: 750

library(shiny)

ui &lt;- fluidPage(
  tags$head(tags$style(HTML("
    .eq-box {
      background: #f0f4f8; border-radius: 6px; padding: 14px;
      margin-bottom: 14px; font-size: 14px; line-height: 1.9;
    }
    .eq-box b { color: #2c3e50; }
    .match  { color: #27ae60; font-weight: bold; }
    .coef   { color: #e74c3c; font-weight: bold; }
  "))),

  sidebarLayout(
    sidebarPanel(
      width = 4,

      sliderInput("n", "Sample size (n):",
                  min = 500, max = 10000, value = 2000, step = 500),

      sliderInput("gamma", HTML("Subsample exponent (&amp;gamma;):"),
                  min = 0.5, max = 0.9, value = 0.7, step = 0.05),

      sliderInput("S", "Number of subsamples (S):",
                  min = 5, max = 30, value = 10, step = 5),

      sliderInput("R", "Reweights per subsample (R):",
                  min = 50, max = 300, value = 100, step = 50),

      sliderInput("B", "Bootstrap replicates (B):",
                  min = 200, max = 1000, value = 500, step = 100),

      actionButton("resim", "Run comparison",
                   class = "btn-primary", width = "100%"),

      uiOutput("results_box")
    ),

    mainPanel(
      width = 8,
      fluidRow(
        column(6, plotOutput("plot_dist", height = "450px")),
        column(6, plotOutput("plot_cost", height = "450px"))
      ),
      uiOutput("explain_box")
    )
  )
)

server &lt;- function(input, output, session) {

  sim_results &lt;- reactive({
    input$resim
    n     &lt;- input$n
    gamma &lt;- input$gamma
    S     &lt;- input$S
    R     &lt;- input$R
    B     &lt;- input$B

    b &lt;- max(10, round(n^gamma))

    # Generate data: Y = 2 + 0.5*X + eps
    x   &lt;- rnorm(n)
    eps &lt;- rnorm(n, sd = 2)
    y   &lt;- 2 + 0.5 * x + eps

    # --- Standard bootstrap ---
    boot_coefs &lt;- numeric(B)
    for (i in seq_len(B)) {
      idx &lt;- sample(n, n, replace = TRUE)
      fit &lt;- lm(y[idx] ~ x[idx])
      boot_coefs[i] &lt;- coef(fit)[2]
    }
    boot_se &lt;- sd(boot_coefs)

    # --- BLB ---
    blb_vars &lt;- numeric(S)
    for (s in seq_len(S)) {
      # Step 1: subsample without replacement
      sub_idx &lt;- sample(n, b, replace = FALSE)
      x_sub &lt;- x[sub_idx]
      y_sub &lt;- y[sub_idx]

      # Step 2: R multinomial reweights
      blb_coefs &lt;- numeric(R)
      for (r in seq_len(R)) {
        # Multinomial weights summing to n
        w &lt;- as.numeric(rmultinom(1, n, rep(1/b, b)))
        # Weighted least squares
        fit_w &lt;- lm(y_sub ~ x_sub, weights = w)
        blb_coefs[r] &lt;- coef(fit_w)[2]
      }
      blb_vars[s] &lt;- var(blb_coefs)
    }
    blb_se &lt;- sqrt(mean(blb_vars))

    # OLS analytic SE for reference
    fit_full &lt;- lm(y ~ x)
    ols_se &lt;- summary(fit_full)$coefficients[2, 2]

    # Cost metrics (observation-fits)
    boot_cost &lt;- B * n
    blb_cost  &lt;- S * R * b

    list(boot_se = boot_se, blb_se = blb_se, ols_se = ols_se,
         boot_coefs = boot_coefs,
         b = b, n = n, S = S, R = R, B = B,
         boot_cost = boot_cost, blb_cost = blb_cost)
  })

  output$plot_dist &lt;- renderPlot({
    d &lt;- sim_results()
    par(mar = c(5, 5, 4, 2))

    hist(d$boot_coefs, breaks = 40,
         col = adjustcolor("#3498db", 0.4), border = "white",
         main = expression("Bootstrap distribution of " * hat(beta)),
         xlab = expression(hat(beta)),
         freq = FALSE)

    # Overlay BLB normal approximation
    x_seq &lt;- seq(min(d$boot_coefs), max(d$boot_coefs),
                 length.out = 200)
    lines(x_seq,
          dnorm(x_seq, mean = 0.5, sd = d$blb_se),
          col = "#27ae60", lwd = 2.5)
    lines(x_seq,
          dnorm(x_seq, mean = 0.5, sd = d$boot_se),
          col = "#3498db", lwd = 2, lty = 2)

    abline(v = 0.5, col = "#e74c3c", lwd = 2)

    legend("topright", bty = "n", cex = 0.85,
           legend = c(
             "Bootstrap histogram",
             paste0("Bootstrap SE = ", round(d$boot_se, 4)),
             paste0("BLB SE = ", round(d$blb_se, 4)),
             expression("True " * beta * " = 0.5")),
           col = c(adjustcolor("#3498db", 0.6),
                   "#3498db", "#27ae60", "#e74c3c"),
           pch = c(15, NA, NA, NA),
           lwd = c(NA, 2, 2.5, 2),
           lty = c(NA, 2, 1, 1),
           pt.cex = 2)
  })

  output$plot_cost &lt;- renderPlot({
    d &lt;- sim_results()
    par(mar = c(5, 5, 4, 2))

    # Show cost comparison across a range of n
    n_range &lt;- seq(500, 10000, by = 500)
    boot_costs &lt;- d$B * n_range
    blb_costs  &lt;- d$S * d$R * round(n_range^(log(d$b) / log(d$n)))

    # Recalculate with same gamma
    gamma &lt;- log(d$b) / log(d$n)
    blb_costs &lt;- d$S * d$R * round(n_range^gamma)

    ylim &lt;- c(0, max(boot_costs) * 1.1)

    plot(n_range, boot_costs, type = "l", lwd = 2.5,
         col = "#3498db",
         xlab = "Sample size (n)",
         ylab = "Observation-fits",
         main = "Computational cost",
         ylim = ylim)
    lines(n_range, blb_costs, lwd = 2.5, col = "#27ae60")

    # Mark current n
    points(d$n, d$boot_cost, pch = 19, cex = 2, col = "#3498db")
    points(d$n, d$blb_cost, pch = 19, cex = 2, col = "#27ae60")

    # Speedup annotation
    speedup &lt;- round(d$boot_cost / d$blb_cost)
    text(d$n, (d$boot_cost + d$blb_cost) / 2,
         paste0(speedup, "x speedup"),
         cex = 1.1, font = 2, col = "#e74c3c")

    legend("topleft", bty = "n", cex = 0.9,
           legend = c(
             paste0("Bootstrap (B\u00d7n)"),
             paste0("BLB (S\u00d7R\u00d7b)")),
           col = c("#3498db", "#27ae60"),
           lwd = 2.5)
  })

  output$results_box &lt;- renderUI({
    d &lt;- sim_results()

    tags$div(class = "eq-box", style = "margin-top: 16px;",
      HTML(paste0(
        "&lt;b&gt;SE comparison:&lt;/b&gt;&lt;br&gt;",
        "OLS analytic: ", round(d$ols_se, 4), "&lt;br&gt;",
        "Bootstrap (B=", d$B, "): &lt;span class='coef'&gt;",
        round(d$boot_se, 4), "&lt;/span&gt;&lt;br&gt;",
        "BLB (S=", d$S, ", R=", d$R, "): &lt;span class='match'&gt;",
        round(d$blb_se, 4), "&lt;/span&gt;&lt;br&gt;",
        "&lt;hr style='margin:8px 0'&gt;",
        "&lt;b&gt;Subsample size:&lt;/b&gt; b = n&lt;sup&gt;",
        round(log(d$b)/log(d$n), 2),
        "&lt;/sup&gt; = ", d$b, "&lt;br&gt;",
        "&lt;b&gt;Speedup:&lt;/b&gt; ",
        round(d$boot_cost / d$blb_cost), "x&lt;br&gt;",
        "&lt;small&gt;Bootstrap: ",
        format(d$boot_cost, big.mark = ","),
        " obs-fits&lt;br&gt;",
        "BLB: ",
        format(d$blb_cost, big.mark = ","),
        " obs-fits&lt;/small&gt;"
      ))
    )
  })

  output$explain_box &lt;- renderUI({
    d &lt;- sim_results()
    tags$div(class = "eq-box", style = "margin-top: 8px;",
      HTML(paste0(
        "&lt;b&gt;Left:&lt;/b&gt; Bootstrap sampling distribution (histogram) with ",
        "bootstrap SE (blue dashed) and BLB SE (green solid) overlaid as ",
        "normal densities. They should nearly coincide. ",
        "&lt;b&gt;Right:&lt;/b&gt; Computational cost as n grows. Bootstrap scales ",
        "linearly; BLB scales as n&lt;sup&gt;&amp;gamma;&lt;/sup&gt; — the gap widens with ",
        "larger data."
      ))
    )
  })
}

shinyApp(ui, server)</code></pre>
<section id="things-to-try" class="level3">
<h3 class="anchored" data-anchor-id="things-to-try">Things to try</h3>
<ul>
<li><strong>Small <span class="math inline">\(n\)</span> (500):</strong> bootstrap and BLB give similar SEs, and the speedup is modest (~5–10x). BLB isn’t worth the complexity here.</li>
<li><strong>Large <span class="math inline">\(n\)</span> (8,000+):</strong> BLB SE still matches bootstrap, but the cost gap explodes. This is where BLB shines.</li>
<li><strong><span class="math inline">\(\gamma = 0.5\)</span> (aggressive subsampling):</strong> subsample is very small. BLB SE may be noisier — you’re working with less data per subsample.</li>
<li><strong><span class="math inline">\(\gamma = 0.9\)</span> (conservative subsampling):</strong> subsample is nearly the full dataset. BLB SE is very stable but the speedup shrinks.</li>
<li><strong>Increase <span class="math inline">\(S\)</span> (more subsamples):</strong> stabilizes the BLB variance estimate across subsamples. Diminishing returns past ~15–20.</li>
<li><strong>Increase <span class="math inline">\(R\)</span> (more reweights):</strong> stabilizes within-subsample variance. Cheap since each reweight is on only <span class="math inline">\(b\)</span> observations.</li>
</ul>
</section>
</section>
<section id="when-to-use-blb" class="level2">
<h2 class="anchored" data-anchor-id="when-to-use-blb">When to use BLB</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Setting</th>
<th>Bootstrap</th>
<th>BLB</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(n &lt; 10{,}000\)</span>, fast estimator</td>
<td>Fine</td>
<td>Overkill</td>
</tr>
<tr class="even">
<td><span class="math inline">\(n &gt; 100{,}000\)</span>, any estimator</td>
<td>Slow</td>
<td>Use BLB</td>
</tr>
<tr class="odd">
<td>Expensive estimator (kernel, ML, ABM)</td>
<td>Very slow</td>
<td>Use BLB</td>
</tr>
<tr class="even">
<td>Distributed computing (data on multiple machines)</td>
<td>Awkward</td>
<td>Natural fit — each subsample on one machine</td>
</tr>
<tr class="odd">
<td>Clustered data</td>
<td>Cluster bootstrap</td>
<td>BLB with clustered subsampling</td>
</tr>
</tbody>
</table>
<p><strong>Rules of thumb:</strong></p>
<ul>
<li>Set <span class="math inline">\(\gamma \in [0.6, 0.8]\)</span>. Lower <span class="math inline">\(\gamma\)</span> = more speedup, more noise.</li>
<li><span class="math inline">\(S = 10\text{–}20\)</span> subsamples is usually enough.</li>
<li><span class="math inline">\(R = 100\text{–}200\)</span> reweights per subsample.</li>
<li>The total cost is <span class="math inline">\(S \times R\)</span> fits on <span class="math inline">\(b\)</span> observations — plan accordingly.</li>
</ul>
</section>
<section id="blb-for-clustered-data" class="level2">
<h2 class="anchored" data-anchor-id="blb-for-clustered-data">BLB for clustered data</h2>
<p>When data has a cluster structure (panels, spatial data), you should <strong>subsample clusters, not observations</strong>. Draw <span class="math inline">\(s\)</span> clusters from the <span class="math inline">\(G\)</span> total clusters, then reweight within them. This preserves the within-cluster correlation structure that <a href="clustered-se.html">clustered SEs</a> are designed to handle.</p>
<p>This is especially relevant for panel econometrics with large <span class="math inline">\(n\)</span> and expensive estimators — exactly the setting where both clustering and computational constraints bind simultaneously.</p>
<hr>
<section id="connections" class="level3">
<h3 class="anchored" data-anchor-id="connections">Connections</h3>
<ul>
<li><a href="bootstrap.html">The Bootstrap</a> — BLB produces the same answer as the standard bootstrap, just faster</li>
<li><a href="clustered-se.html">Clustered SEs</a> — BLB can be adapted to preserve cluster structure via clustered subsampling</li>
<li><a href="monte-carlo.html">Monte Carlo Experiments</a> — BLB is a way to make Monte Carlo-style inference feasible at scale</li>
</ul>
<hr>
</section>
<section id="did-you-know" class="level3">
<h3 class="anchored" data-anchor-id="did-you-know">Did you know?</h3>
<ul>
<li><strong>BLB</strong> was introduced by <strong>Kleiner, Talwalkar, Sarkar, and Michael I. Jordan</strong> in 2014 at UC Berkeley. Jordan is one of the most influential figures in both statistics and machine learning — he supervised Andrew Ng and helped develop variational inference, among many other contributions.</li>
<li>The name “Bag of Little Bootstraps” is a deliberate riff on <strong>bagging</strong> (Bootstrap AGGregatING), Leo Breiman’s 1996 method for reducing variance in prediction. Both use resampling on subsets, but for different purposes: bagging reduces prediction variance, BLB estimates parameter uncertainty.</li>
<li>BLB is particularly natural for <strong>MapReduce/Spark</strong> distributed computing: each subsample lives on one worker node, reweighting is embarrassingly parallel, and only the variance estimates need to be communicated back. This made it popular at tech companies dealing with massive datasets.</li>
<li>The subsample size <span class="math inline">\(b = n^\gamma\)</span> is not arbitrary — the theory requires <span class="math inline">\(b \to \infty\)</span> and <span class="math inline">\(b/n \to 0\)</span> for consistency. The power law <span class="math inline">\(n^\gamma\)</span> with <span class="math inline">\(\gamma &lt; 1\)</span> satisfies both conditions and gives a clean cost-accuracy tradeoff.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><span style="white-space:nowrap">© 2026 <a href="https://nencydhameja.com">Nency Dhameja</a> | <a href="../index.html">All Notes</a> | Developed with AI assistance | <a href="mailto:nencydhameja@gmail.com">Feedback?</a></span></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>