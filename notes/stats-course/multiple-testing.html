<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Multiple Testing &amp; the Replication Crisis – Foundations of Statistical Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d279e387f5997211c97d65d1670dc95e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<meta name="shinylive:serviceworker_dir" content=".">
<script src="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/run-python-blocks.js" type="module"></script>
<link href="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/shinylive.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pvalues-ci.html">Inference</a></li><li class="breadcrumb-item"><a href="./multiple-testing.html">Multiple Testing</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Foundations of Statistical Inference</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Probability &amp; Uncertainty</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variance-sd-se.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variance, SD &amp; Standard Error</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampling-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Sampling Distribution</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">The Central Limit Theorem</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CLT Simulator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lln.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LLN vs CLT</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pvalues-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">p-values &amp; Confidence Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Test Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Bootstrap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Power, Alpha, Beta &amp; MDE</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./monte-carlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Monte Carlo Experiments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-testing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Multiple Testing</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cef.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression &amp; the CEF</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./residuals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Residuals &amp; Controls</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fwl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frisch-Waugh-Lovell</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Algebra of Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Algebra Behind OLS</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Estimation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./method-of-moments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Method of Moments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maximum-likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maximum Likelihood</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Method of Moments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Estimation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Standard Errors &amp; Diagnostics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./heteroskedasticity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Heteroskedasticity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustered-se.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clustered SEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./measurement-error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measurement Error</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bias-variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bias-Variance Tradeoff</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./degeneracy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">When Inference Breaks Down</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Causal Thinking</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation-causation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">From Correlation to Causation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Bayesian Thinking</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian-updating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Updating</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Foundations of AI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./training-as-mle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Training as Maximum Likelihood</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regularization-priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regularization as Bayesian Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction-vs-causation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prediction vs Causation in Foundation Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimental Design for AI Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calibration-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calibration &amp; Uncertainty Quantification</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-problem-test-enough-things-and-something-will-be-significant" id="toc-the-problem-test-enough-things-and-something-will-be-significant" class="nav-link active" data-scroll-target="#the-problem-test-enough-things-and-something-will-be-significant">The problem: test enough things and something will be “significant”</a>
  <ul class="collapse">
  <li><a href="#how-it-happens-in-practice" id="toc-how-it-happens-in-practice" class="nav-link" data-scroll-target="#how-it-happens-in-practice">How it happens in practice</a></li>
  </ul></li>
  <li><a href="#simulation-1-false-discoveries-from-multiple-tests" id="toc-simulation-1-false-discoveries-from-multiple-tests" class="nav-link" data-scroll-target="#simulation-1-false-discoveries-from-multiple-tests">Simulation 1: False discoveries from multiple tests</a></li>
  <li><a href="#simulation-2-correction-methods-compared" id="toc-simulation-2-correction-methods-compared" class="nav-link" data-scroll-target="#simulation-2-correction-methods-compared">Simulation 2: Correction methods compared</a>
  <ul class="collapse">
  <li><a href="#things-to-try" id="toc-things-to-try" class="nav-link" data-scroll-target="#things-to-try">Things to try</a></li>
  <li><a href="#when-to-use-which-correction" id="toc-when-to-use-which-correction" class="nav-link" data-scroll-target="#when-to-use-which-correction">When to use which correction</a></li>
  <li><a href="#the-bottom-line" id="toc-the-bottom-line" class="nav-link" data-scroll-target="#the-bottom-line">The bottom line</a></li>
  <li><a href="#did-you-know" id="toc-did-you-know" class="nav-link" data-scroll-target="#did-you-know">Did you know?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pvalues-ci.html">Inference</a></li><li class="breadcrumb-item"><a href="./multiple-testing.html">Multiple Testing</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Multiple Testing &amp; the Replication Crisis</h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="the-problem-test-enough-things-and-something-will-be-significant" class="level2">
<h2 class="anchored" data-anchor-id="the-problem-test-enough-things-and-something-will-be-significant">The problem: test enough things and something will be “significant”</h2>
<p>If you test one null hypothesis at <span class="math inline">\(\alpha = 0.05\)</span>, there’s a 5% chance of a false positive. But if you test <strong>20</strong> null hypotheses, the chance that <em>at least one</em> is falsely significant is:</p>
<p><span class="math display">\[P(\text{at least one false positive}) = 1 - (1 - 0.05)^{20} \approx 0.64\]</span></p>
<p>That’s a <strong>64% chance</strong> of finding something “significant” even when nothing is real. This is the <strong>multiple testing problem</strong>, and it’s at the heart of the replication crisis.</p>
<section id="how-it-happens-in-practice" class="level3">
<h3 class="anchored" data-anchor-id="how-it-happens-in-practice">How it happens in practice</h3>
<ul>
<li>A researcher tests 20 outcome variables and reports the one with p &lt; 0.05</li>
<li>A genetics study tests 500,000 SNPs for association with a disease</li>
<li>An A/B test checks conversions, clicks, revenue, time on page, bounce rate…</li>
<li>A psychology experiment tests the effect on 10 different mood scales</li>
</ul>
<p>In each case, the nominal <span class="math inline">\(\alpha = 0.05\)</span> no longer controls the actual false positive rate. You need a <strong>correction</strong>.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>The Oracle View.</strong> In these simulations, we know which effects are real and which are null — so we can count exactly how many “significant” results are true discoveries vs false alarms. In practice, when you get a significant p-value, you never know which kind it is. That’s why corrections matter.</p>
</div>
</div>
</div>
</section>
</section>
<section id="simulation-1-false-discoveries-from-multiple-tests" class="level2">
<h2 class="anchored" data-anchor-id="simulation-1-false-discoveries-from-multiple-tests">Simulation 1: False discoveries from multiple tests</h2>
<p>Test 20 true null hypotheses at <span class="math inline">\(\alpha = 0.05\)</span>. Watch how many come up “significant” purely by chance. Repeat to see the pattern.</p>
<pre class="shinylive-r" data-engine="r"><code>#| standalone: true
#| viewerHeight: 650

library(shiny)

ui &lt;- fluidPage(
  tags$head(tags$style(HTML("
    .stats-box {
      background: #f0f4f8; border-radius: 6px; padding: 14px;
      margin-top: 12px; font-size: 14px; line-height: 1.9;
    }
    .stats-box b { color: #2c3e50; }
    .good { color: #27ae60; font-weight: bold; }
    .bad  { color: #e74c3c; font-weight: bold; }
  "))),

  sidebarLayout(
    sidebarPanel(
      width = 3,

      sliderInput("n_tests", "Number of hypotheses tested:",
                  min = 5, max = 50, value = 20, step = 5),

      sliderInput("n_obs", "Sample size per test:",
                  min = 20, max = 200, value = 50, step = 10),

      sliderInput("alpha", HTML("&amp;alpha; (per-test):"),
                  min = 0.01, max = 0.10, value = 0.05, step = 0.01),

      sliderInput("n_real", "Number with real effects:",
                  min = 0, max = 10, value = 0, step = 1),

      actionButton("go", "Run tests",
                   class = "btn-primary", width = "100%"),

      uiOutput("results")
    ),

    mainPanel(
      width = 9,
      plotOutput("pval_plot", height = "520px")
    )
  )
)

server &lt;- function(input, output, session) {

  dat &lt;- reactive({
    input$go
    m     &lt;- input$n_tests
    n     &lt;- input$n_obs
    alpha &lt;- input$alpha
    n_real &lt;- min(input$n_real, m)

    p_vals &lt;- numeric(m)
    is_real &lt;- rep(FALSE, m)

    for (i in seq_len(m)) {
      if (i &lt;= n_real) {
        # Real effect (d = 0.5)
        x &lt;- rnorm(n, mean = 0.5, sd = 1)
        is_real[i] &lt;- TRUE
      } else {
        # Null is true
        x &lt;- rnorm(n, mean = 0, sd = 1)
      }
      p_vals[i] &lt;- t.test(x, mu = 0)$p.value
    }

    # Bonferroni correction
    bonf_alpha &lt;- alpha / m
    bonf_reject &lt;- p_vals &lt; bonf_alpha

    # BH (FDR) correction
    sorted_idx &lt;- order(p_vals)
    sorted_p &lt;- p_vals[sorted_idx]
    bh_threshold &lt;- (seq_len(m) / m) * alpha
    bh_max &lt;- max(c(0, which(sorted_p &lt;= bh_threshold)))
    bh_reject &lt;- rep(FALSE, m)
    if (bh_max &gt; 0) bh_reject[sorted_idx[seq_len(bh_max)]] &lt;- TRUE

    list(p_vals = p_vals, is_real = is_real, m = m, n = n,
         alpha = alpha, n_real = n_real,
         raw_reject = p_vals &lt; alpha,
         bonf_reject = bonf_reject,
         bh_reject = bh_reject,
         bonf_alpha = bonf_alpha)
  })

  output$pval_plot &lt;- renderPlot({
    d &lt;- dat()
    par(mar = c(4.5, 6, 3, 1))

    ord &lt;- order(d$p_vals)
    p_sorted &lt;- d$p_vals[ord]
    real_sorted &lt;- d$is_real[ord]

    cols &lt;- ifelse(real_sorted, "#3498db", "#95a5a6")
    pch_vals &lt;- ifelse(real_sorted, 17, 16)

    plot(p_sorted, seq_len(d$m), pch = pch_vals, cex = 1.5,
         col = cols, xlim = c(0, 1),
         xlab = "p-value", ylab = "Test (sorted by p-value)",
         main = paste0(d$m, " hypothesis tests (", d$n_real,
                      " real effects)"),
         yaxt = "n")
    axis(2, at = seq_len(d$m), labels = seq_len(d$m),
         las = 1, cex.axis = 0.7)

    # Alpha threshold
    abline(v = d$alpha, lty = 2, lwd = 2, col = "#e74c3c")
    text(d$alpha + 0.02, d$m, paste0("\u03b1 = ", d$alpha),
         col = "#e74c3c", cex = 0.8, adj = 0)

    # Bonferroni threshold
    abline(v = d$bonf_alpha, lty = 2, lwd = 2, col = "#e67e22")
    text(d$bonf_alpha + 0.02, d$m - 1,
         paste0("Bonf = ", round(d$bonf_alpha, 4)),
         col = "#e67e22", cex = 0.8, adj = 0)

    # BH line
    bh_line &lt;- (seq_len(d$m) / d$m) * d$alpha
    lines(bh_line[ord], seq_len(d$m), lty = 3, lwd = 2, col = "#27ae60")

    # Highlight rejections
    raw_sig &lt;- which(p_sorted &lt; d$alpha)
    if (length(raw_sig) &gt; 0) {
      points(p_sorted[raw_sig], raw_sig, pch = 1, cex = 2.5,
             col = "#e74c3c", lwd = 2)
    }

    legend("bottomright", bty = "n", cex = 0.8,
           legend = c(
             ifelse(d$n_real &gt; 0, "Real effect", ""),
             "Null (no effect)",
             paste0("Uncorrected \u03b1 = ", d$alpha),
             paste0("Bonferroni \u03b1 = ", round(d$bonf_alpha, 4)),
             "BH (FDR) threshold"
           )[c(d$n_real &gt; 0, TRUE, TRUE, TRUE, TRUE)],
           col = c(
             if (d$n_real &gt; 0) "#3498db",
             "#95a5a6", "#e74c3c", "#e67e22", "#27ae60"
           ),
           pch = c(
             if (d$n_real &gt; 0) 17,
             16, NA, NA, NA
           ),
           lwd = c(
             if (d$n_real &gt; 0) NA,
             NA, 2, 2, 2
           ),
           lty = c(
             if (d$n_real &gt; 0) NA,
             NA, 2, 2, 3
           ))
  })

  output$results &lt;- renderUI({
    d &lt;- dat()

    raw_fp &lt;- sum(d$raw_reject &amp; !d$is_real)
    bonf_fp &lt;- sum(d$bonf_reject &amp; !d$is_real)
    bh_fp &lt;- sum(d$bh_reject &amp; !d$is_real)

    raw_tp &lt;- sum(d$raw_reject &amp; d$is_real)
    bonf_tp &lt;- sum(d$bonf_reject &amp; d$is_real)
    bh_tp &lt;- sum(d$bh_reject &amp; d$is_real)

    tags$div(class = "stats-box",
      HTML(paste0(
        "&lt;b&gt;Uncorrected:&lt;/b&gt;&lt;br&gt;",
        "&amp;nbsp; Reject: ", sum(d$raw_reject),
        " (FP: &lt;span class='bad'&gt;", raw_fp, "&lt;/span&gt;",
        if (d$n_real &gt; 0) paste0(", TP: ", raw_tp), ")&lt;br&gt;",
        "&lt;b&gt;Bonferroni:&lt;/b&gt;&lt;br&gt;",
        "&amp;nbsp; Reject: ", sum(d$bonf_reject),
        " (FP: ", bonf_fp,
        if (d$n_real &gt; 0) paste0(", TP: ", bonf_tp), ")&lt;br&gt;",
        "&lt;b&gt;BH (FDR):&lt;/b&gt;&lt;br&gt;",
        "&amp;nbsp; Reject: ", sum(d$bh_reject),
        " (FP: ", bh_fp,
        if (d$n_real &gt; 0) paste0(", TP: ", bh_tp), ")&lt;br&gt;",
        "&lt;hr style='margin:8px 0'&gt;",
        "&lt;small&gt;FP = false positive&lt;br&gt;",
        "TP = true positive&lt;/small&gt;"
      ))
    )
  })
}

shinyApp(ui, server)</code></pre>
</section>
<section id="simulation-2-correction-methods-compared" class="level2">
<h2 class="anchored" data-anchor-id="simulation-2-correction-methods-compared">Simulation 2: Correction methods compared</h2>
<p>Run the multiple testing experiment many times to see the long-run performance of each correction method. Track the <strong>family-wise error rate</strong> (FWER: any false positive?) and <strong>false discovery rate</strong> (FDR: what fraction of discoveries are false?).</p>
<pre class="shinylive-r" data-engine="r"><code>#| standalone: true
#| viewerHeight: 520

library(shiny)

ui &lt;- fluidPage(
  tags$head(tags$style(HTML("
    .stats-box {
      background: #f0f4f8; border-radius: 6px; padding: 14px;
      margin-top: 12px; font-size: 14px; line-height: 1.9;
    }
    .stats-box b { color: #2c3e50; }
    .good { color: #27ae60; font-weight: bold; }
    .bad  { color: #e74c3c; font-weight: bold; }
  "))),

  sidebarLayout(
    sidebarPanel(
      width = 3,

      sliderInput("m2", "Number of tests:",
                  min = 5, max = 50, value = 20, step = 5),

      sliderInput("n_real2", "Tests with real effects:",
                  min = 0, max = 10, value = 3, step = 1),

      sliderInput("sims2", "Simulations:",
                  min = 200, max = 1000, value = 500, step = 100),

      actionButton("go2", "Run simulations",
                   class = "btn-primary", width = "100%"),

      uiOutput("results2")
    ),

    mainPanel(
      width = 9,
      plotOutput("compare_plot", height = "420px")
    )
  )
)

server &lt;- function(input, output, session) {

  dat &lt;- reactive({
    input$go2
    m      &lt;- input$m2
    n_real &lt;- min(input$n_real2, m)
    sims   &lt;- input$sims2
    n      &lt;- 50
    alpha  &lt;- 0.05

    fwer &lt;- c(raw = 0, bonf = 0, bh = 0)
    power &lt;- c(raw = 0, bonf = 0, bh = 0)
    fdr_sum &lt;- c(raw = 0, bonf = 0, bh = 0)
    fdr_count &lt;- c(raw = 0, bonf = 0, bh = 0)

    for (s in seq_len(sims)) {
      p_vals &lt;- numeric(m)
      is_real &lt;- rep(FALSE, m)

      for (i in seq_len(m)) {
        if (i &lt;= n_real) {
          x &lt;- rnorm(n, mean = 0.5, sd = 1)
          is_real[i] &lt;- TRUE
        } else {
          x &lt;- rnorm(n, mean = 0, sd = 1)
        }
        p_vals[i] &lt;- t.test(x, mu = 0)$p.value
      }

      # Raw
      raw_rej &lt;- p_vals &lt; alpha

      # Bonferroni
      bonf_rej &lt;- p_vals &lt; (alpha / m)

      # BH
      sorted_idx &lt;- order(p_vals)
      sorted_p &lt;- p_vals[sorted_idx]
      bh_thresh &lt;- (seq_len(m) / m) * alpha
      bh_max &lt;- max(c(0, which(sorted_p &lt;= bh_thresh)))
      bh_rej &lt;- rep(FALSE, m)
      if (bh_max &gt; 0) bh_rej[sorted_idx[seq_len(bh_max)]] &lt;- TRUE

      for (method in list(list("raw", raw_rej),
                          list("bonf", bonf_rej),
                          list("bh", bh_rej))) {
        nm &lt;- method[[1]]
        rej &lt;- method[[2]]

        # FWER
        if (any(rej &amp; !is_real)) fwer[nm] &lt;- fwer[nm] + 1

        # Power (if any real effects)
        if (n_real &gt; 0) {
          power[nm] &lt;- power[nm] + sum(rej &amp; is_real)
        }

        # FDR
        if (sum(rej) &gt; 0) {
          fdr_sum[nm] &lt;- fdr_sum[nm] + sum(rej &amp; !is_real) / sum(rej)
          fdr_count[nm] &lt;- fdr_count[nm] + 1
        }
      }
    }

    fwer &lt;- fwer / sims
    if (n_real &gt; 0) power &lt;- power / (sims * n_real)
    fdr &lt;- ifelse(fdr_count &gt; 0, fdr_sum / fdr_count, 0)

    list(fwer = fwer, power = power, fdr = fdr,
         m = m, n_real = n_real, sims = sims)
  })

  output$compare_plot &lt;- renderPlot({
    d &lt;- dat()
    par(mar = c(4.5, 4.5, 3, 6), xpd = TRUE)

    methods &lt;- c("Uncorrected", "Bonferroni", "BH (FDR)")
    cols &lt;- c("#e74c3c", "#e67e22", "#27ae60")
    x_pos &lt;- seq_along(methods)

    if (d$n_real &gt; 0) {
      # Show both FWER and power
      mat &lt;- rbind(d$fwer * 100, d$power * 100)
      bp &lt;- barplot(mat, beside = TRUE, names.arg = methods,
                    col = c("#e74c3c80", "#3498db80"),
                    border = c("#e74c3c", "#3498db"),
                    ylim = c(0, 100),
                    ylab = "Rate (%)",
                    main = paste0("FWER &amp; Power (", d$sims,
                                 " simulations, ", d$n_real,
                                 " real effects)"))

      abline(h = 5, lty = 2, lwd = 2, col = "#7f8c8d")
      text(max(bp) + 1, 7, "\u03b1 = 5%", cex = 0.8, col = "#7f8c8d")

      legend("topright", inset = c(-0.18, 0), bty = "n", cex = 0.85,
             legend = c("FWER", "Power"),
             fill = c("#e74c3c80", "#3498db80"),
             border = c("#e74c3c", "#3498db"))
    } else {
      bp &lt;- barplot(d$fwer * 100, names.arg = methods,
                    col = cols, border = NA,
                    ylim = c(0, max(d$fwer * 100) * 1.3),
                    ylab = "Family-wise error rate (%)",
                    main = paste0("FWER under H\u2080 (",
                                 d$sims, " simulations)"))

      abline(h = 5, lty = 2, lwd = 2, col = "#7f8c8d")
      text(max(bp) + 0.3, 7, "Target: 5%", cex = 0.8, col = "#7f8c8d")

      text(bp, d$fwer * 100 + 2,
           paste0(round(d$fwer * 100, 1), "%"), cex = 0.9)
    }
  })

  output$results2 &lt;- renderUI({
    d &lt;- dat()

    tags$div(class = "stats-box",
      HTML(paste0(
        "&lt;b&gt;FWER (any false positive):&lt;/b&gt;&lt;br&gt;",
        "&amp;nbsp; Uncorrected: &lt;span class='bad'&gt;",
        round(d$fwer["raw"] * 100, 1), "%&lt;/span&gt;&lt;br&gt;",
        "&amp;nbsp; Bonferroni: &lt;span class='good'&gt;",
        round(d$fwer["bonf"] * 100, 1), "%&lt;/span&gt;&lt;br&gt;",
        "&amp;nbsp; BH: ", round(d$fwer["bh"] * 100, 1), "%&lt;br&gt;",
        if (d$n_real &gt; 0) paste0(
          "&lt;hr style='margin:8px 0'&gt;",
          "&lt;b&gt;Power (detect real effects):&lt;/b&gt;&lt;br&gt;",
          "&amp;nbsp; Uncorrected: ", round(d$power["raw"] * 100, 1), "%&lt;br&gt;",
          "&amp;nbsp; Bonferroni: ", round(d$power["bonf"] * 100, 1), "%&lt;br&gt;",
          "&amp;nbsp; BH: ", round(d$power["bh"] * 100, 1), "%"
        ) else ""
      ))
    )
  })
}

shinyApp(ui, server)</code></pre>
<section id="things-to-try" class="level3">
<h3 class="anchored" data-anchor-id="things-to-try">Things to try</h3>
<ul>
<li><strong>20 tests, 0 real effects:</strong> uncorrected FWER is ~64%. Bonferroni brings it to ~5%. BH is somewhere in between.</li>
<li><strong>20 tests, 3 real effects:</strong> Bonferroni controls FWER tightly but has lower power. BH controls the <em>false discovery rate</em> (what fraction of your discoveries are wrong) while maintaining better power.</li>
<li><strong>50 tests, 0 real effects:</strong> uncorrected FWER is over 90%. The more you test, the worse it gets.</li>
<li><strong>Sim 1 with 0 real effects:</strong> click “Run tests” repeatedly. Each time, a different set of null hypotheses appears “significant.” This is exactly how researchers accidentally find spurious results.</li>
</ul>
</section>
<section id="when-to-use-which-correction" class="level3">
<h3 class="anchored" data-anchor-id="when-to-use-which-correction">When to use which correction</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 35%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Controls</th>
<th>Best for</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>None</strong></td>
<td>Per-comparison <span class="math inline">\(\alpha\)</span></td>
<td>Single pre-registered hypothesis</td>
</tr>
<tr class="even">
<td><strong>Bonferroni</strong></td>
<td>FWER (any false positive)</td>
<td>Safety-critical decisions; few tests</td>
</tr>
<tr class="odd">
<td><strong>BH (Benjamini-Hochberg)</strong></td>
<td>FDR (false discovery proportion)</td>
<td>Exploratory analysis; many tests</td>
</tr>
<tr class="even">
<td><strong>Pre-registration</strong></td>
<td>Everything</td>
<td>Specify your hypothesis <em>before</em> seeing data</td>
</tr>
</tbody>
</table>
</section>
<section id="the-bottom-line" class="level3">
<h3 class="anchored" data-anchor-id="the-bottom-line">The bottom line</h3>
<ul>
<li><strong>If you test enough things, something will be significant.</strong> The question is whether it’s real.</li>
<li><strong>Bonferroni</strong> is conservative — it controls the probability of <em>any</em> false positive but sacrifices power.</li>
<li><strong>BH</strong> is more permissive — it controls the <em>proportion</em> of discoveries that are false, giving you better power.</li>
<li>The best correction is <strong>not testing everything.</strong> Pre-register your primary hypothesis and keep the number of tests small.</li>
</ul>
<hr>
</section>
<section id="did-you-know" class="level3">
<h3 class="anchored" data-anchor-id="did-you-know">Did you know?</h3>
<ul>
<li>The XKCD comic <a href="https://xkcd.com/882/">“Significant”</a> perfectly illustrates the multiple testing problem: researchers test whether jelly beans cause acne, testing 20 different colors. Green jelly beans come up significant at p &lt; 0.05 — and the newspaper headline reads “Green Jelly Beans Linked to Acne!”</li>
<li><strong>John Ioannidis</strong> published “Why Most Published Research Findings Are False” in 2005. His argument: when studies are underpowered, when many hypotheses are tested, and when researchers have flexibility in their analysis, the majority of “significant” findings are likely false positives. The paper has been cited over 10,000 times and helped launch the <strong>replication crisis</strong> movement.</li>
<li><strong>Benjamini and Hochberg</strong> published their FDR procedure in 1995. It was initially met with skepticism — why would you <em>allow</em> some false discoveries? But in fields like genomics, where you test thousands of genes simultaneously, controlling the <em>proportion</em> of false discoveries turns out to be much more practical (and powerful) than trying to prevent any single false positive.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><span style="white-space:nowrap">© 2026 <a href="https://nencydhameja.com">Nency Dhameja</a> | <a href="../index.html">All Notes</a> | Developed with AI assistance | <a href="mailto:nencydhameja@gmail.com">Feedback?</a></span></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>