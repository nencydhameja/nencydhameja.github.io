<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>When ML Helps and When It Doesn’t – Applied Causal Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d279e387f5997211c97d65d1670dc95e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./potential-outcomes.html">Framework</a></li><li class="breadcrumb-item"><a href="./when-ml-helps.html">When ML Helps and When It Doesn’t</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Causal Inference</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Framework</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./potential-outcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Potential Outcomes &amp; ATE</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./identification-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Identification vs Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./when-ml-helps.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">When ML Helps and When It Doesn’t</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./selection-observables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Selection on Observables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./did.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Difference-in-Differences</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./iv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instrumental Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rdd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Discontinuity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./synth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Synthetic Control</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Panel Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./panel-fe-re.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fixed vs Random Effects</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Estimation Tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-adjustment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Adjustment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ipw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IPW</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./entropy-balancing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Entropy Balancing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./doubly-robust.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Doubly Robust</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./double-debiased-ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Double/Debiased ML</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Beyond Averages</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./heterogeneous-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Heterogeneous Treatment Effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causal-forests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estimating Heterogeneous Effects</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-separation-principle" id="toc-the-separation-principle" class="nav-link active" data-scroll-target="#the-separation-principle">The separation principle</a></li>
  <li><a href="#where-ml-helps" id="toc-where-ml-helps" class="nav-link" data-scroll-target="#where-ml-helps">Where ML helps</a>
  <ul class="collapse">
  <li><a href="#high-dimensional-confounders" id="toc-high-dimensional-confounders" class="nav-link" data-scroll-target="#high-dimensional-confounders">1. High-dimensional confounders</a></li>
  <li><a href="#nonlinear-relationships" id="toc-nonlinear-relationships" class="nav-link" data-scroll-target="#nonlinear-relationships">2. Nonlinear relationships</a></li>
  <li><a href="#discovering-treatment-effect-heterogeneity" id="toc-discovering-treatment-effect-heterogeneity" class="nav-link" data-scroll-target="#discovering-treatment-effect-heterogeneity">3. Discovering treatment effect heterogeneity</a></li>
  <li><a href="#improving-precision" id="toc-improving-precision" class="nav-link" data-scroll-target="#improving-precision">4. Improving precision</a></li>
  </ul></li>
  <li><a href="#where-ml-does-not-help" id="toc-where-ml-does-not-help" class="nav-link" data-scroll-target="#where-ml-does-not-help">Where ML does not help</a>
  <ul class="collapse">
  <li><a href="#unobserved-confounding" id="toc-unobserved-confounding" class="nav-link" data-scroll-target="#unobserved-confounding">1. Unobserved confounding</a></li>
  <li><a href="#providing-identification" id="toc-providing-identification" class="nav-link" data-scroll-target="#providing-identification">2. Providing identification</a></li>
  <li><a href="#small-samples" id="toc-small-samples" class="nav-link" data-scroll-target="#small-samples">3. Small samples</a></li>
  <li><a href="#interpretability-of-nuisance-functions" id="toc-interpretability-of-nuisance-functions" class="nav-link" data-scroll-target="#interpretability-of-nuisance-functions">4. Interpretability of nuisance functions</a></li>
  </ul></li>
  <li><a href="#a-decision-framework" id="toc-a-decision-framework" class="nav-link" data-scroll-target="#a-decision-framework">A decision framework</a></li>
  <li><a href="#connecting-to-the-course" id="toc-connecting-to-the-course" class="nav-link" data-scroll-target="#connecting-to-the-course">Connecting to the course</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./potential-outcomes.html">Framework</a></li><li class="breadcrumb-item"><a href="./when-ml-helps.html">When ML Helps and When It Doesn’t</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">When ML Helps and When It Doesn’t</h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>Machine learning is transforming parts of empirical research. But it is not transforming all parts equally, and understanding <em>where</em> ML helps is as important as knowing the methods. This page draws the boundary.</p>
<section id="the-separation-principle" class="level2">
<h2 class="anchored" data-anchor-id="the-separation-principle">The separation principle</h2>
<p><a href="identification-estimation.html">Identification vs Estimation</a> established that every causal study has two components:</p>
<ol type="1">
<li><strong>Identification:</strong> the argument for <em>why</em> a comparison is causal</li>
<li><strong>Estimation:</strong> the procedure for <em>computing</em> the causal parameter from data</li>
</ol>
<p>Machine learning helps with <strong>estimation</strong>. It does not help with <strong>identification</strong>. This is the separation principle, and it is the single most important idea in causal ML.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 37%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">What ML improves</th>
<th style="text-align: left;">What ML does not improve</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Nuisance estimation</td>
<td style="text-align: left;">Propensity scores, outcome models</td>
<td style="text-align: left;">The argument for unconfoundedness</td>
</tr>
<tr class="even">
<td style="text-align: left;">Functional form</td>
<td style="text-align: left;">Nonlinear, high-dimensional adjustment</td>
<td style="text-align: left;">Whether the adjustment variables are sufficient</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Heterogeneity</td>
<td style="text-align: left;">Flexible CATE estimation</td>
<td style="text-align: left;">Whether the ATE is identified in the first place</td>
</tr>
<tr class="even">
<td style="text-align: left;">Prediction</td>
<td style="text-align: left;">Out-of-sample forecasting</td>
<td style="text-align: left;">Whether the forecast has a causal interpretation</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>The Manski principle, restated.</strong> No estimator — OLS, random forest, neural network, or transformer — can identify a causal parameter that the research design does not identify. Identification is a property of the data-generating process and the assumptions you’re willing to make, not the statistical method you apply. ML makes estimation more flexible; it does not make identification less necessary.</p>
</div>
</div>
</div>
</section>
<section id="where-ml-helps" class="level2">
<h2 class="anchored" data-anchor-id="where-ml-helps">Where ML helps</h2>
<section id="high-dimensional-confounders" class="level3">
<h3 class="anchored" data-anchor-id="high-dimensional-confounders">1. High-dimensional confounders</h3>
<p>When the set of potential confounders is large — dozens or hundreds of variables — traditional methods struggle. You can’t include 200 variables in a logistic regression for the propensity score without overfitting. ML methods (lasso, random forests, boosting) handle high-dimensional covariate adjustment naturally.</p>
<p><a href="double-debiased-ml.html">DML</a> provides the framework: use ML for the nuisance functions (propensity score, outcome model), cross-fit to avoid overfitting bias, and use Neyman orthogonal scores for valid inference on the causal parameter.</p>
</section>
<section id="nonlinear-relationships" class="level3">
<h3 class="anchored" data-anchor-id="nonlinear-relationships">2. Nonlinear relationships</h3>
<p>If the outcome depends on covariates in complex, nonlinear ways, a linear outcome model is misspecified. ML methods can capture these nonlinearities without the researcher having to specify them in advance (which polynomial terms, which interactions).</p>
<p>This is where <a href="doubly-robust.html">doubly robust estimation</a> and DML intersect: the DR structure protects against misspecification of either model, and ML provides flexible estimators that reduce the risk of misspecification in the first place.</p>
</section>
<section id="discovering-treatment-effect-heterogeneity" class="level3">
<h3 class="anchored" data-anchor-id="discovering-treatment-effect-heterogeneity">3. Discovering treatment effect heterogeneity</h3>
<p><a href="heterogeneous-effects.html">Heterogeneous treatment effects</a> showed that causal forests and meta-learners can estimate <span class="math inline">\(\tau(x)\)</span> — revealing which subgroups benefit most from treatment. This is genuinely new: traditional subgroup analysis requires pre-specifying which subgroups to examine, while ML-based methods can search over many covariates simultaneously.</p>
</section>
<section id="improving-precision" class="level3">
<h3 class="anchored" data-anchor-id="improving-precision">4. Improving precision</h3>
<p>Even when a simple estimator is consistent, ML-based covariate adjustment can reduce variance. In randomized experiments, the ATE is identified by randomization — you don’t need covariate adjustment for consistency. But adjusting for predictive covariates reduces the residual variance and tightens confidence intervals. ML can identify which covariates are most predictive without the researcher specifying a functional form.</p>
</section>
</section>
<section id="where-ml-does-not-help" class="level2">
<h2 class="anchored" data-anchor-id="where-ml-does-not-help">Where ML does not help</h2>
<section id="unobserved-confounding" class="level3">
<h3 class="anchored" data-anchor-id="unobserved-confounding">1. Unobserved confounding</h3>
<p>If treatment assignment depends on an unobserved variable <span class="math inline">\(U\)</span>:</p>
<p><span class="math display">\[
Y(0), Y(1) \not\perp D \mid X
\]</span></p>
<p>then no method — parametric or nonparametric — can estimate the ATE consistently from observational data on <span class="math inline">\((Y, D, X)\)</span> alone. ML estimates <span class="math inline">\(E[Y \mid X, D]\)</span> more flexibly, but a more flexible approximation to a confounded conditional expectation is still confounded.</p>
<p>This is the failure mode that <a href="identification-estimation.html">identification</a> guards against. The solution is not a better estimator — it is a better research design (an instrument, a discontinuity, a natural experiment).</p>
</section>
<section id="providing-identification" class="level3">
<h3 class="anchored" data-anchor-id="providing-identification">2. Providing identification</h3>
<p>ML can estimate <span class="math inline">\(P(Y \mid X)\)</span> but not <span class="math inline">\(P(Y \mid do(X))\)</span> — the distinction from the <a href="../stats-course/prediction-vs-causation.html">stats course</a>. The interventional distribution requires knowledge of the causal structure (a DAG, an exclusion restriction, a parallel trends argument). ML methods are agnostic about causal structure by design — they optimize prediction, not identification.</p>
</section>
<section id="small-samples" class="level3">
<h3 class="anchored" data-anchor-id="small-samples">3. Small samples</h3>
<p>ML methods generally require large samples to outperform simple parametric models. With <span class="math inline">\(n = 200\)</span>, a lasso propensity score is unlikely to improve on a carefully specified logit. DML’s cross-fitting further reduces effective sample size. In small samples, domain knowledge and parametric modeling often dominate data-driven flexibility.</p>
</section>
<section id="interpretability-of-nuisance-functions" class="level3">
<h3 class="anchored" data-anchor-id="interpretability-of-nuisance-functions">4. Interpretability of nuisance functions</h3>
<p>When a random forest estimates the propensity score, you lose the ability to inspect and interpret the model. You can’t point to specific coefficients and say “age increases treatment probability by X percentage points.” This matters when the propensity score model is of substantive interest (understanding selection into treatment) rather than just a statistical tool.</p>
</section>
</section>
<section id="a-decision-framework" class="level2">
<h2 class="anchored" data-anchor-id="a-decision-framework">A decision framework</h2>
<p>When deciding whether to use ML in a causal study:</p>
<pre><code>Is the causal parameter identified?
├── No → Fix the research design. ML cannot help.
└── Yes → Are nuisance functions well-approximated by simple models?
    ├── Yes → Standard parametric methods are fine. ML adds complexity
    │         without clear benefit.
    └── No → ML-based estimation (DML, causal forests) can help.
        ├── Is the sample large enough? (n &gt; 1000 as rough guide)
        │   ├── Yes → Proceed with DML / causal forests
        │   └── No → Consider regularized parametric models (lasso)
        └── Do you need heterogeneous effects?
            ├── Yes → Causal forests, meta-learners
            └── No → DML for ATE</code></pre>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>The honest summary.</strong> ML is a powerful tool for the <em>estimation</em> half of causal inference. It handles high-dimensional confounders, nonlinear relationships, and heterogeneous effects better than traditional parametric methods. But it is entirely silent on the <em>identification</em> half — the question of whether the causal parameter can be recovered at all. The most sophisticated ML pipeline applied to a confounded comparison produces a precise, confident, wrong answer.</p>
</div>
</div>
</div>
</section>
<section id="connecting-to-the-course" class="level2">
<h2 class="anchored" data-anchor-id="connecting-to-the-course">Connecting to the course</h2>
<p>This page synthesizes the entire causal ML section:</p>
<ul>
<li><strong><a href="identification-estimation.html">Identification vs Estimation</a>:</strong> the foundational distinction that structures everything above</li>
<li><strong><a href="double-debiased-ml.html">DML</a>:</strong> the primary framework for using ML in causal estimation</li>
<li><strong><a href="heterogeneous-effects.html">Heterogeneous Effects</a>:</strong> the main setting where ML provides genuinely new capabilities</li>
<li><strong><a href="doubly-robust.html">Doubly Robust</a>:</strong> the estimation structure that DML builds on</li>
<li><strong><a href="../stats-course/prediction-vs-causation.html">Prediction vs Causation</a>:</strong> the distinction between <span class="math inline">\(P(Y \mid X)\)</span> and <span class="math inline">\(P(Y \mid do(X))\)</span>, applied to foundation models</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2026 <a href="https://nencydhameja.com">Nency Dhameja</a> | <a href="../index.html">All Notes</a><br><span style="white-space:nowrap">Developed with AI assistance</span></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>