[{"name":"app.R","content":"library(shiny)\n\n# ---------------------------------------------------------------------------\n# Helper: draw a single random sample from the chosen distribution\n# ---------------------------------------------------------------------------\ndraw_sample <- function(n, dist) {\n  switch(dist,\n    \"Uniform(0, 1)\"      = runif(n),\n    \"Exponential(1)\"     = rexp(n, rate = 1),\n    \"Right-skewed (χ²₃)\" = rchisq(n, df = 3),\n    \"Bimodal\"            = {\n      k <- rbinom(n, 1, 0.5)\n      k * rnorm(n, mean = -2, sd = 0.6) + (1 - k) * rnorm(n, mean = 2, sd = 0.6)\n    },\n    \"Bernoulli(0.3)\"     = rbinom(n, size = 1, prob = 0.3),\n    runif(n)\n  )\n}\n\n# Theoretical mean & sd of each parent distribution\npop_params <- list(\n  \"Uniform(0, 1)\"      = list(mu = 0.5,  sigma = sqrt(1 / 12)),\n  \"Exponential(1)\"     = list(mu = 1,    sigma = 1),\n  \"Right-skewed (χ²₃)\" = list(mu = 3,    sigma = sqrt(6)),\n  \"Bimodal\"            = list(mu = 0,    sigma = sqrt(0.6^2 + 4)),\n  \"Bernoulli(0.3)\"     = list(mu = 0.3,  sigma = sqrt(0.3 * 0.7))\n)\n\n# ---------------------------------------------------------------------------\n# UI\n# ---------------------------------------------------------------------------\nui <- fluidPage(\n\n  tags$head(tags$style(HTML(\"\n    body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; }\n    .well { background-color: #f7f7f7; }\n    h2   { color: #2c3e50; }\n    .stats-box {\n      background: #eaf2f8; border-radius: 6px; padding: 14px;\n      margin-top: 12px; font-size: 14px; line-height: 1.8;\n    }\n    .stats-box b { color: #2c3e50; }\n  \"))),\n\n  titlePanel(\"Central Limit Theorem Simulator\"),\n\n  sidebarLayout(\n    sidebarPanel(\n      width = 3,\n\n      selectInput(\"dist\", \"Population distribution:\",\n                  choices = names(pop_params)),\n\n      sliderInput(\"n\", \"Sample size (n):\",\n                  min = 1, max = 200, value = 5, step = 1),\n\n      sliderInput(\"reps\", \"Number of samples:\",\n                  min = 100, max = 5000, value = 1000, step = 100),\n\n      actionButton(\"resample\", \"Draw new samples\",\n                   class = \"btn-primary\", width = \"100%\"),\n\n      uiOutput(\"stats_box\")\n    ),\n\n    mainPanel(\n      width = 9,\n      fluidRow(\n        column(6, plotOutput(\"parent_plot\", height = \"400px\")),\n        column(6, plotOutput(\"sampling_plot\", height = \"400px\"))\n      )\n    )\n  )\n)\n\n# ---------------------------------------------------------------------------\n# Server\n# ---------------------------------------------------------------------------\nserver <- function(input, output, session) {\n\n  # Re-run whenever the button is clicked OR an input changes\n  sim <- reactive({\n    input$resample\n    n    <- input$n\n    reps <- input$reps\n    dist <- input$dist\n\n    means <- replicate(reps, mean(draw_sample(n, dist)))\n\n    params <- pop_params[[dist]]\n    theo_mu <- params$mu\n    theo_se <- params$sigma / sqrt(n)\n\n    list(means = means, dist = dist, n = n, reps = reps,\n         theo_mu = theo_mu, theo_se = theo_se)\n  })\n\n  # --- Left panel: true population (DGP) ---\n  output$parent_plot <- renderPlot({\n    dist <- input$dist\n    big  <- draw_sample(10000, dist)\n\n    par(mar = c(4.5, 4, 3, 1))\n    hist(big, breaks = 60, probability = TRUE,\n         col = \"#d5e8d4\", border = \"#82b366\",\n         main = paste(\"True Population:\", dist),\n         xlab = \"x\", ylab = \"Density\")\n  })\n\n  # --- Right panel: sampling distribution of the mean ---\n  output$sampling_plot <- renderPlot({\n    s <- sim()\n\n    par(mar = c(4.5, 4, 3, 1))\n    hist(s$means, breaks = 40, probability = TRUE,\n         col = \"#dae8fc\", border = \"#6c8ebf\",\n         main = paste0(\"Sampling Distribution of x̄  (n = \", s$n, \")\"),\n         xlab = \"Sample mean\", ylab = \"Density\")\n\n    # Overlay the theoretical normal curve\n    x_seq <- seq(min(s$means), max(s$means), length.out = 300)\n    lines(x_seq, dnorm(x_seq, mean = s$theo_mu, sd = s$theo_se),\n          col = \"#e74c3c\", lwd = 2.5)\n\n    # Mark the theoretical mean\n    abline(v = s$theo_mu, lty = 2, lwd = 2, col = \"#2c3e50\")\n\n    legend(\"topright\",\n           legend = c(\"Normal approximation\", \"Theoretical mean\"),\n           col    = c(\"#e74c3c\", \"#2c3e50\"),\n           lwd    = c(2.5, 2),\n           lty    = c(1, 2),\n           bty    = \"n\", cex = 0.9)\n  })\n\n  # --- Stats summary ---\n  output$stats_box <- renderUI({\n    s <- sim()\n    tags$div(class = \"stats-box\",\n      HTML(paste0(\n        \"<b>Theoretical mean:<\/b> \",   round(s$theo_mu, 4), \"<br>\",\n        \"<b>Observed mean of x̄:<\/b> \", round(mean(s$means), 4), \"<br>\",\n        \"<b>Theoretical SE:<\/b> \",     round(s$theo_se, 4), \"<br>\",\n        \"<b>Observed SD of x̄:<\/b> \",  round(sd(s$means), 4)\n      ))\n    )\n  })\n}\n\nshinyApp(ui, server)\n","type":"text"}]
