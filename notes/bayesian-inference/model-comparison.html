<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Model Comparison – Introduction to Bayesian Thinking</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d279e387f5997211c97d65d1670dc95e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<meta name="shinylive:serviceworker_dir" content=".">
<script src="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/run-python-blocks.js" type="module"></script>
<link href="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/shinylive.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./model-comparison.html">Putting It Together</a></li><li class="breadcrumb-item"><a href="./model-comparison.html">Model Comparison</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Bayesian Thinking</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes-theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayes’ Theorem</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./priors-posteriors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Priors &amp; Posteriors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./shrinkage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Shrinkage</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes-vs-freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian vs Frequentist</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Beyond Conjugates</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hierarchical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Putting It Together</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-comparison.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Model Comparison</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./posterior-predictive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Posterior Predictive Checks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./application.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Application: Returns to Education</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#which-model-is-better" id="toc-which-model-is-better" class="nav-link active" data-scroll-target="#which-model-is-better">Which model is better?</a></li>
  <li><a href="#connection-to-bic" id="toc-connection-to-bic" class="nav-link" data-scroll-target="#connection-to-bic">Connection to BIC</a>
  <ul class="collapse">
  <li><a href="#simulation-does-x-belong-in-the-model" id="toc-simulation-does-x-belong-in-the-model" class="nav-link" data-scroll-target="#simulation-does-x-belong-in-the-model">Simulation: Does X belong in the model?</a></li>
  <li><a href="#things-to-try" id="toc-things-to-try" class="nav-link" data-scroll-target="#things-to-try">Things to try</a></li>
  </ul></li>
  <li><a href="#in-stata" id="toc-in-stata" class="nav-link" data-scroll-target="#in-stata">In Stata</a></li>
  <li><a href="#did-you-know" id="toc-did-you-know" class="nav-link" data-scroll-target="#did-you-know">Did you know?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./model-comparison.html">Putting It Together</a></li><li class="breadcrumb-item"><a href="./model-comparison.html">Model Comparison</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Model Comparison</h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="which-model-is-better" class="level2">
<h2 class="anchored" data-anchor-id="which-model-is-better">Which model is better?</h2>
<p>You’ve built a model — maybe a regression with three predictors. A colleague suggests dropping one. Frequentists compare models with F-tests or likelihood ratio tests. Bayesians have their own answer: <strong>Bayes factors</strong>.</p>
<p>The idea is simple. Compute the <strong>marginal likelihood</strong> of each model — how well the model predicted the data, averaging over all possible parameter values — and take the ratio:</p>
<p><span class="math display">\[
\text{BF}_{10} = \frac{p(\mathbf{y} \mid M_1)}{p(\mathbf{y} \mid M_0)}
\]</span></p>
<p>where <span class="math inline">\(p(\mathbf{y} \mid M_k) = \int p(\mathbf{y} \mid \theta, M_k) \, p(\theta \mid M_k) \, d\theta\)</span>.</p>
<p>A Bayes factor of 10 means the data are 10 times more likely under <span class="math inline">\(M_1\)</span> than <span class="math inline">\(M_0\)</span>. Unlike a p-value, Bayes factors can support the null — a BF of 0.1 means the data favor <span class="math inline">\(M_0\)</span> by a factor of 10.</p>
<p>To get <strong>posterior odds</strong> between models, multiply the Bayes factor by your <strong>prior odds</strong>:</p>
<p><span class="math display">\[
\underbrace{\frac{P(M_1 \mid \mathbf{y})}{P(M_0 \mid \mathbf{y})}}_{\text{posterior odds}}
= \underbrace{\frac{P(M_1)}{P(M_0)}}_{\text{prior odds}}
\times \underbrace{\text{BF}_{10}}_{\text{Bayes factor}}
\]</span></p>
<p>With equal prior odds (50/50 between models), the posterior odds equal the Bayes factor.</p>
<p><strong>Jeffreys’ interpretation scale:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>BF₁₀</th>
<th>Evidence for M₁</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1–3</td>
<td>Anecdotal</td>
</tr>
<tr class="even">
<td>3–10</td>
<td>Substantial</td>
</tr>
<tr class="odd">
<td>10–30</td>
<td>Strong</td>
</tr>
<tr class="even">
<td>30–100</td>
<td>Very strong</td>
</tr>
<tr class="odd">
<td>&gt; 100</td>
<td>Decisive</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Reading BF &lt; 1:</strong> If BF₁₀ = 0.05, that’s the same as BF₀₁ = 20 — strong evidence <em>for</em> the null. Bayes factors are symmetric: just flip the ratio.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="connection-to-bic" class="level2">
<h2 class="anchored" data-anchor-id="connection-to-bic">Connection to BIC</h2>
<p>Computing the marginal likelihood exactly requires integrating over the prior — often intractable. But there’s a shortcut you already have.</p>
<p>The <strong>Bayesian Information Criterion</strong> (BIC) approximates the log marginal likelihood:</p>
<p><span class="math display">\[
\text{BIC} \approx -2 \log p(\mathbf{y} \mid M) + \text{const}
\]</span></p>
<p>So the difference in BIC between two models approximates the log Bayes factor:</p>
<p><span class="math display">\[
\Delta\text{BIC} = \text{BIC}_1 - \text{BIC}_0 \approx -2 \log \text{BF}_{10}
\]</span></p>
<p>which gives us:</p>
<p><span class="math display">\[
\text{BF}_{10} \approx \exp\!\left(-\tfrac{\Delta\text{BIC}}{2}\right)
\]</span></p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>BIC is the lazy Bayes factor.</strong> It doesn’t require specifying priors — it uses an implicit “unit information prior.” You already get BIC from Stata’s <code>estat ic</code>. To approximate a Bayes factor, just compute <span class="math inline">\(\exp(-\Delta\text{BIC}/2)\)</span>.</p>
</div>
</div>
</div>
<p><strong>Three approaches compared:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Approach</th>
<th>Favors M₁ when</th>
<th>Can support null?</th>
<th>Requires prior?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>p-value</td>
<td>p &lt; 0.05</td>
<td>No (only rejects)</td>
<td>No</td>
</tr>
<tr class="even">
<td>BIC</td>
<td>ΔBIC &lt; 0</td>
<td>Yes (ΔBIC &gt; 0)</td>
<td>No (implicit)</td>
</tr>
<tr class="odd">
<td>Bayes factor</td>
<td>BF₁₀ &gt; 1</td>
<td>Yes (BF₁₀ &lt; 1)</td>
<td>Yes (explicit)</td>
</tr>
</tbody>
</table>
<hr>
<section id="simulation-does-x-belong-in-the-model" class="level3">
<h3 class="anchored" data-anchor-id="simulation-does-x-belong-in-the-model">Simulation: Does X belong in the model?</h3>
<p>Compare two models: <span class="math inline">\(M_0\)</span>: <span class="math inline">\(y = \text{noise}\)</span> vs <span class="math inline">\(M_1\)</span>: <span class="math inline">\(y = \beta x + \text{noise}\)</span>. The Bayes factor tells you whether the data support including <span class="math inline">\(x\)</span>.</p>
<pre class="shinylive-r" data-engine="r"><code>#| standalone: true
#| viewerHeight: 620

library(shiny)

ui &lt;- fluidPage(
  tags$head(tags$style(HTML("
    .stats-box {
      background: #f0f4f8; border-radius: 6px; padding: 14px;
      margin-top: 12px; font-size: 14px; line-height: 1.9;
    }
    .stats-box b { color: #2c3e50; }
    .good  { color: #27ae60; font-weight: bold; }
    .bad   { color: #e74c3c; font-weight: bold; }
    .muted { color: #7f8c8d; }
  "))),

  sidebarLayout(
    sidebarPanel(
      width = 3,

      sliderInput("true_beta", HTML("True &amp;beta;:"),
                  min = 0, max = 3, value = 0, step = 0.25),

      sliderInput("prior_sd", "Prior SD on &amp;beta;:",
                  min = 0.1, max = 5, value = 1, step = 0.1),

      sliderInput("n", "Sample size (n):",
                  min = 10, max = 300, value = 50, step = 10),

      sliderInput("sigma", HTML("Noise (&amp;sigma;):"),
                  min = 0.5, max = 5, value = 2, step = 0.5),

      actionButton("go", "New data", class = "btn-primary", width = "100%"),

      uiOutput("results")
    ),

    mainPanel(
      width = 9,
      fluidRow(
        column(6, plotOutput("density_plot", height = "420px")),
        column(6, plotOutput("bf_plot", height = "420px"))
      )
    )
  )
)

server &lt;- function(input, output, session) {

  dat &lt;- reactive({
    input$go
    true_beta &lt;- input$true_beta
    prior_sd  &lt;- input$prior_sd
    n         &lt;- input$n
    sigma     &lt;- input$sigma

    # Generate data
    x &lt;- rnorm(n, 0, 1)
    y &lt;- true_beta * x + rnorm(n, 0, sigma)

    # OLS estimate under M1
    beta_ols &lt;- sum(x * y) / sum(x^2)
    se_ols   &lt;- sigma / sqrt(sum(x^2))

    # Bayesian posterior under M1 (prior: beta ~ N(0, prior_sd^2))
    prior_prec &lt;- 1 / prior_sd^2
    data_prec  &lt;- sum(x^2) / sigma^2
    post_prec  &lt;- prior_prec + data_prec
    post_sd    &lt;- 1 / sqrt(post_prec)
    post_mean  &lt;- (0 * prior_prec + beta_ols * data_prec) / post_prec

    # Savage-Dickey BF: BF10 = prior density at 0 / posterior density at 0
    prior_at_0 &lt;- dnorm(0, 0, prior_sd)
    post_at_0  &lt;- dnorm(0, post_mean, post_sd)
    bf_10      &lt;- prior_at_0 / post_at_0

    # BIC approximation
    # Under M0: RSS = sum(y^2); Under M1: RSS = sum((y - beta_ols*x)^2)
    rss0 &lt;- sum(y^2)
    rss1 &lt;- sum((y - beta_ols * x)^2)
    bic0 &lt;- n * log(rss0 / n) + 0 * log(n)
    bic1 &lt;- n * log(rss1 / n) + 1 * log(n)
    delta_bic &lt;- bic1 - bic0
    bf_bic    &lt;- exp(-delta_bic / 2)

    # Jeffreys label
    abf &lt;- bf_10
    label &lt;- if (abf &gt; 100) "Decisive for M1"
             else if (abf &gt; 30) "Very strong for M1"
             else if (abf &gt; 10) "Strong for M1"
             else if (abf &gt; 3) "Substantial for M1"
             else if (abf &gt; 1) "Anecdotal for M1"
             else if (abf &gt; 1/3) "Anecdotal for M0"
             else if (abf &gt; 1/10) "Substantial for M0"
             else if (abf &gt; 1/30) "Strong for M0"
             else if (abf &gt; 1/100) "Very strong for M0"
             else "Decisive for M0"

    list(x = x, y = y, beta_ols = beta_ols, se_ols = se_ols,
         prior_sd = prior_sd, post_mean = post_mean, post_sd = post_sd,
         prior_at_0 = prior_at_0, post_at_0 = post_at_0,
         bf_10 = bf_10, delta_bic = delta_bic, bf_bic = bf_bic,
         label = label, true_beta = true_beta)
  })

  output$density_plot &lt;- renderPlot({
    d &lt;- dat()
    par(mar = c(4.5, 4.5, 3, 1))

    # Plot range
    xlim &lt;- c(min(-3 * d$prior_sd, d$post_mean - 4 * d$post_sd),
              max(3 * d$prior_sd, d$post_mean + 4 * d$post_sd))
    x_seq &lt;- seq(xlim[1], xlim[2], length.out = 400)

    prior_y &lt;- dnorm(x_seq, 0, d$prior_sd)
    post_y  &lt;- dnorm(x_seq, d$post_mean, d$post_sd)

    ylim &lt;- c(0, max(c(prior_y, post_y)) * 1.2)

    plot(NULL, xlim = xlim, ylim = ylim,
         xlab = expression(beta), ylab = "Density",
         main = "Savage-Dickey: Prior vs Posterior at \u03b2 = 0")

    # Prior (red dashed)
    lines(x_seq, prior_y, col = "#e74c3c", lwd = 2, lty = 2)

    # Posterior (blue filled)
    polygon(c(x_seq, rev(x_seq)), c(post_y, rep(0, length(x_seq))),
            col = "#3498db30", border = NA)
    lines(x_seq, post_y, col = "#3498db", lwd = 2.5)

    # Mark densities at beta = 0
    segments(0, 0, 0, d$prior_at_0, col = "#e74c3c", lwd = 2, lty = 3)
    points(0, d$prior_at_0, pch = 16, col = "#e74c3c", cex = 1.5)

    segments(0, 0, 0, d$post_at_0, col = "#3498db", lwd = 2, lty = 3)
    points(0, d$post_at_0, pch = 16, col = "#3498db", cex = 1.5)

    # Labels
    text(0, d$prior_at_0, pos = 4, cex = 0.8, col = "#e74c3c",
         labels = paste0("Prior(0) = ", round(d$prior_at_0, 3)))
    text(0, d$post_at_0, pos = 4, cex = 0.8, col = "#3498db",
         labels = paste0("Post(0) = ", round(d$post_at_0, 3)))

    legend("topright", bty = "n", cex = 0.85,
           legend = c("Prior", "Posterior"),
           col = c("#e74c3c", "#3498db"),
           lwd = c(2, 2.5), lty = c(2, 1))
  })

  output$bf_plot &lt;- renderPlot({
    d &lt;- dat()
    par(mar = c(4.5, 6, 3, 1))

    log_bf  &lt;- log10(d$bf_10)
    log_bic &lt;- log10(d$bf_bic)

    vals &lt;- c(log_bf, log_bic)
    xlim &lt;- range(c(vals, -2.5, 2.5))
    xlim &lt;- c(min(xlim[1], -2.5), max(xlim[2], 2.5))

    bp &lt;- barplot(vals, horiz = TRUE,
                  names.arg = c("Bayes Factor", "BIC approx"),
                  col = c("#3498db", "#f39c12"),
                  xlim = xlim, las = 1, border = NA,
                  main = expression("log"[10] * "(BF"[10] * ")"),
                  xlab = expression("log"[10] * "(BF"[10] * ")"))

    # Jeffreys reference lines
    abline(v = 0, lty = 1, col = "#2c3e50", lwd = 1.5)
    ref_vals &lt;- c(log10(3), log10(10), log10(30), log10(100),
                  -log10(3), -log10(10), -log10(30), -log10(100))
    ref_labs &lt;- c("3", "10", "30", "100", "1/3", "1/10", "1/30", "1/100")

    for (i in seq_along(ref_vals)) {
      if (ref_vals[i] &gt;= xlim[1] &amp;&amp; ref_vals[i] &lt;= xlim[2]) {
        abline(v = ref_vals[i], lty = 3, col = "#bdc3c7")
      }
    }

    # Label regions
    text(xlim[2] * 0.85, mean(bp), "Favors M1 \u2192", cex = 0.8, col = "#27ae60")
    text(xlim[1] * 0.85, mean(bp), "\u2190 Favors M0", cex = 0.8, col = "#e74c3c")
  })

  output$results &lt;- renderUI({
    d &lt;- dat()
    label_class &lt;- if (d$bf_10 &gt;= 3) "good"
                   else if (d$bf_10 &lt;= 1/3) "bad"
                   else "muted"

    tags$div(class = "stats-box",
      HTML(paste0(
        "&lt;b&gt;BF\u2081\u2080:&lt;/b&gt; ", round(d$bf_10, 3), "&lt;br&gt;",
        "&lt;b&gt;log\u2081\u2080(BF):&lt;/b&gt; ", round(log10(d$bf_10), 3), "&lt;br&gt;",
        "&lt;hr style='margin:8px 0'&gt;",
        "&lt;b&gt;\u0394BIC:&lt;/b&gt; ", round(d$delta_bic, 2), "&lt;br&gt;",
        "&lt;b&gt;BIC-approx BF:&lt;/b&gt; ", round(d$bf_bic, 3), "&lt;br&gt;",
        "&lt;hr style='margin:8px 0'&gt;",
        "&lt;b&gt;Verdict:&lt;/b&gt; &lt;span class='", label_class, "'&gt;",
        d$label, "&lt;/span&gt;"
      ))
    )
  })
}

shinyApp(ui, server)</code></pre>
</section>
<section id="things-to-try" class="level3">
<h3 class="anchored" data-anchor-id="things-to-try">Things to try</h3>
<ul>
<li><strong>True β = 0 (null is true):</strong> the Bayes factor favors <span class="math inline">\(M_0\)</span>. Unlike a p-value that can only “fail to reject,” the BF actively supports the null.</li>
<li><strong>True β = 2:</strong> the BF strongly favors <span class="math inline">\(M_1\)</span>. Increase n to make the evidence decisive.</li>
<li><strong>Wide prior (prior SD = 5):</strong> even when β is truly nonzero, a very wide prior penalizes <span class="math inline">\(M_1\)</span>. The prior spreads probability over implausible values, wasting “predictive budget.” This is <strong>Lindley’s paradox</strong>: a vague Bayesian can reject a true effect.</li>
<li><strong>Narrow prior (prior SD = 0.5) centered at 0:</strong> a tight prior makes <span class="math inline">\(M_1\)</span> more efficient — if the truth is near 0, <span class="math inline">\(M_1\)</span> predicts nearly as well as <span class="math inline">\(M_0\)</span>.</li>
<li><strong>Watch the left panel:</strong> the Savage-Dickey ratio is literally prior density at 0 divided by posterior density at 0. When the posterior shifts away from 0, the denominator shrinks and the BF grows.</li>
<li><strong>Compare BF and BIC:</strong> they usually agree in direction but the magnitudes differ. BIC is a large-sample approximation, so they converge with bigger n.</li>
</ul>
<hr>
</section>
</section>
<section id="in-stata" class="level2">
<h2 class="anchored" data-anchor-id="in-stata">In Stata</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>* Fit <span class="kw">two</span> competing models</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>bayes: <span class="kw">reg</span> <span class="fu">y</span> x1 <span class="kw">x2</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>bayesstats <span class="kw">ic</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>bayes: <span class="kw">reg</span> <span class="fu">y</span> x1</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>bayesstats <span class="kw">ic</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>* Compare DIC/WAIC across models</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>* Lower DIC <span class="kw">or</span> WAIC = better predictive <span class="kw">fit</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>* ΔDIC works like ΔBIC: bigger gap = stronger preference</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Quick BIC-based Bayes factor:</strong> Run frequentist models, use <code>estat ic</code> to get BIC, then compute <code>display exp(-(BIC1 - BIC0)/2)</code> for an approximate Bayes factor. No MCMC needed.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="did-you-know" class="level2">
<h2 class="anchored" data-anchor-id="did-you-know">Did you know?</h2>
<ul>
<li><p><strong>Jeffreys (1961)</strong> proposed the interpretation scale for Bayes factors in <em>Theory of Probability</em>. His categories — anecdotal, substantial, strong, very strong, decisive — remain the standard reference, though some Bayesians caution against rigid thresholds (just as with p = 0.05).</p></li>
<li><p><strong>Lindley’s paradox (1957):</strong> with a sufficiently large sample, a vague prior can lead the Bayes factor to favor the null even when the p-value is tiny. The resolution: the BF is sensitive to the <em>spread</em> of the prior, not just its center. A prior of <span class="math inline">\(N(0, 1000^2)\)</span> says you think β could be anywhere from -3000 to 3000 — that’s a real claim, and the data punish it.</p></li>
<li><p><strong>Kass &amp; Raftery (1995)</strong> wrote the definitive review of Bayes factors, proposing modified guidelines and advocating BIC as a practical approximation. Their paper remains one of the most cited in Bayesian statistics.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2026 <a href="https://nencydhameja.com">Nency Dhameja</a> | <a href="../index.html">All Notes</a><br><span style="white-space:nowrap">Developed with AI assistance</span></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>